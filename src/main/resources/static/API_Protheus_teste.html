<!DOCTYPE html>
<html lang="pt-BR">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Clientes API</title>
        <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
        <style>
            body {
                background-color: #f8f9fa;
            }
        </style>
    </head>

<body>
    <div class="container mt-5">
        <h1>Gerenciamento de Clientes</h1>
        <button id="listarClientes" class="btn btn-primary mb-3">Listar Clientes</button>

        <div id="clientes" class="list-group mb-3"></div>

        <h3>Adicionar Cliente</h3>
        <form id="formCliente">
            <div class="form-group">
                <label for="codigo">Codigo</label>
                <input type="text" class="form-control" id="codigo" required>
            </div>
            <div class="form-group">
                <label for="loja">Loja</label>
                <input type="text" class="form-control" id="loja" required>
            </div>
            <div class="form-group">
                <label for="razao">Razão</label>
                <input type="text" class="form-control" id="razao" required>
            </div>
            <div class="form-group">
                <label for="tipo">Tipo</label>
                <input type="text" class="form-control" id="tipo" required>
            </div>
            <div class="form-group">
                <label for="nomefantasia">Nome Fantasia</label>
                <input type="text" class="form-control" id="nomefantasia" required>
            </div>
            <div class="form-group">
                <label for="finalidade">Finalidade</label>
                <input type="text" class="form-control" id="finalidade" required>
            </div>
            <div class="form-group">
                <label for="cnpj">Cnpj</label>
                <input type="text" class="form-control" id="cnpj">
            </div>
            <div class="form-group">
                <label for="cep">Cep</label>
                <input type="text" class="form-control" id="cep">
            </div>
            <div class="form-group">
                <label for="pais">Pais</label>
                <input type="text" class="form-control" id="pais">
            </div>
            <div class="form-group">
                <label for="estado">Estado</label>
                <input type="text" class="form-control" id="estado" required>
            </div>
            <div class="form-group">
                <label for="codmunicipio">Cod Municipio</label>
                <input type="text" class="form-control" id="codmunicipio">
            </div>
            <div class="form-group">
                <label for="cidade">Cidade</label>
                <input type="text" class="form-control" id="cidade" required>
            </div>
            <div class="form-group">
                <label for="endereco">Endereco</label>
                <input type="text" class="form-control" id="endereco" required>
            </div>
            <div class="form-group">
                <label for="bairro">Bairro</label>
                <input type="text" class="form-control" id="bairro">
            </div>
            <div class="form-group">
                <label for="ddd">DDD</label>
                <input type="text" class="form-control" id="ddd">
            </div>
            <div class="form-group">
                <label for="telefone">Telefone</label>
                <input type="text" class="form-control" id="telefone">
            </div>
            <div class="form-group">
                <label for="abertura">Abertura</label>
                <input type="text" class="form-control" id="abertura">
            </div>
            <div class="form-group">
                <label for="contato">Contato</label>
                <input type="text" class="form-control" id="contato">
            </div>
            <div class="form-group">
                <label for="email">Email</label>
                <input type="text" class="form-control" id="email">
            </div>
            <div class="form-group">
                <label for="homepage">Homepage</label>
                <input type="text" class="form-control" id="homepage">
            </div>
            <button type="submit" class="btn btn-success">Adicionar Cliente</button>
        </form>
    </div>

    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script>

            const username = 'restadmin';
            const password = 'R3st@dm1N2';
            const apiUrl = 'http://localhost:8080/api/clientes'; // Substitua pela URL real da sua API
            const headers = new Headers();
            headers.append('Authorization', 'Basic cmVzdGFkbWluOlIzc3RAZG0xTjI=' );//+ btoa(username + ':' + password));

            // Listar Clientes
            document.getElementById('listarClientes').addEventListener('click', function() {
                fetch(`${apiUrl}/listarClientes`, { headers: headers })
                    .then(response => {
                        if (!response.ok) {
                            alert('Erro ao conectar com a API: ' + response.statusText);
                            throw new Error('Erro na rede');
                        }
                        return response.json();
                    })
                    .then(data => {
                        const clientesDiv = document.getElementById('clientes');
                        clientesDiv.innerHTML = ''; // Limpa a lista antes de adicionar

                        data.forEach(cliente => {
                            const clienteItem = document.createElement('div');
                            clienteItem.className = 'list-group-item list-group-item-action';
                            clienteItem.innerHTML = `
                                <strong>Código:</strong> ${cliente.codigo}<br>
                                <strong>Loja:</strong> ${cliente.loja}<br>
                                <strong>Razão Social:</strong> ${cliente.razao}<br>
                                <strong>Tipo:</strong> ${cliente.tipo}<br>
                                <strong>Nome Fantasia:</strong> ${cliente.nomefantasia}<br>
                                <strong>Finalidade:</strong> ${cliente.finalidade}<br>
                                <strong>CNPJ:</strong> ${cliente.cnpj}<br>
                                <strong>CEP:</strong> ${cliente.cep}<br>
                                <strong>País:</strong> ${cliente.pais}<br>
                                <strong>Estado:</strong> ${cliente.estado}<br>
                                <strong>Código Município:</strong> ${cliente.codmunicipio}<br>
                                <strong>Cidade:</strong> ${cliente.cidade}<br>
                                <strong>Endereço:</strong> ${cliente.endereco}<br>
                                <strong>Bairro:</strong> ${cliente.bairro}<br>
                                <strong>DDD:</strong> ${cliente.ddd}<br>
                                <strong>Telefone:</strong> ${cliente.telefone}<br>
                                <strong>Abertura:</strong> ${cliente.abertura}<br>
                                <strong>Contato:</strong> ${cliente.contato}<br>
                                <strong>Email:</strong> ${cliente.email}<br>
                                <strong>Homepage:</strong> ${cliente.homepage}<br>
                            `;
                            clientesDiv.appendChild(clienteItem);
                        });

                        alert('Clientes listados com sucesso!');
                    })
                    .catch(error => console.error('Erro:', error));
            });

            // Adicionar Cliente
            document.getElementById('formCliente').addEventListener('submit', function(event) {
            event.preventDefault();

            const loja = document.getElementById('loja').value;
            const razao = document.getElementById('razao').value;
            const tipo = document.getElementById('tipo').value;
            const nomefantasia = document.getElementById('nomefantasia').value;
            const finalidade = document.getElementById('finalidade').value;
            const cnpj = document.getElementById('cnpj').value;
            const cep = document.getElementById('cep').value;
            const pais = document.getElementById('pais').value;
            const estado = document.getElementById('estado').value;
            const codmunicipio = document.getElementById('codmunicipio').value;
            const cidade = document.getElementById('cidade').value;
            const endereco = document.getElementById('endereco').value;
            const bairro = document.getElementById('bairro').value;
            const ddd = document.getElementById('ddd').value;
            const telefone = document.getElementById('telefone').value;
            const abertura = document.getElementById('abertura').value;
            const contato = document.getElementById('contato').value;
            const email = document.getElementById('email').value;
            const homepage = document.getElementById('homepage').value;

            const novoCliente = {
                loja: loja,
                razao: razao,
                tipo: tipo,
                nomefantasia: nomefantasia,
                finalidade: finalidade,
                cnpj: cnpj,
                cep: cep,
                pais: pais,
                estado: estado,
                codmunicipio: codmunicipio,
                cidade: cidade,
                endereco: endereco,
                bairro: bairro,
                ddd: ddd,
                telefone: telefone,
                abertura: abertura,
                contato: contato,
                email: email,
                homepage: homepage
            };

            fetch(`${apiUrl}/criarCliente`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'Authorization': 'Basic ' + btoa(username + ':' + password)
                },
                body: JSON.stringify(novoCliente)
            })
            .then(response => {
                if (response.ok) {
                    alert('Cliente adicionado com sucesso!');
                    document.getElementById('formCliente').reset();
                } else {
                    alert('Erro ao adicionar cliente: ' + response.statusText);
                }
            })
            .catch(error => console.error('Erro:', error));
        });
    </script>
</body>
</html>
